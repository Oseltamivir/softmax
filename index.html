<!-- softmax-calculator.html -->
<meta charset="utf-8" />
<title>Soft‑max Visualiser</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
  body{margin:0;padding:0;width:100%;font:14px system-ui,sans-serif}
  .wrapper{max-width:100%;padding:16px}
  #chart{width:100%;height:450px}
  #slider{margin:12px 0;width:100%}
  .label{font-weight:600}
</style>

<div class="wrapper">
  <h2>Soft‑max of [ 1 , <span id="zcount">3</span>×0 ]</h2>

  <label class="label">Number of zeros: <span id="zeros">3</span></label>
  <input type="range" id="slider" min="0" max="50" value="3"/>

  <canvas id="chart"></canvas>
</div>

<script>
// ---------- soft‑max ----------
const softmax = a => {
  const e = a.map(Math.exp), s = e.reduce((x,y)=>x+y,0);
  return e.map(v=>v/s);
};

// ---------- draw --------------
const ctx = document.getElementById('chart');
let chart;

function render(n){
  const logits = [1, ...Array(n).fill(0)];
  const probs  = softmax(logits);

  const commonOpts = {
    borderWidth:1,
    data:probs,
    pointRadius:0,
    order:1            // keep in front of bars
  };

  const data = {
    labels: probs.map((_,i)=>`idx ${i}`),
    datasets:[
      { type:'bar',
        backgroundColor:'#3182ce66',   // translucent blue
        ...commonOpts, order:2          // draw bars first
      },
      { type:'line',
        borderColor:'rgba(0,0,0,0.35)', // faint grey curve
        fill:false, tension:0.35,
        ...commonOpts
      }
    ]
  };

  chart?.destroy();
  chart = new Chart(ctx,{
    data,
    options:{
      responsive:true,
      animation:false,
      scales:{
        x:{
          ticks:{ display:false },      // remove x‑axis labels
          grid:{ display:false }
        },
        y:{
          min:0, max:1,                 // freeze y‑axis
          ticks:{ stepSize:0.2 },
          grid:{ color:'rgba(0,0,0,0.05)' }
        }
      },
      plugins:{ legend:{ display:false } }
    }
  });
}

// ---------- slider ------------
const slider = document.getElementById('slider');
const zeros  = document.getElementById('zeros');
const zcount = document.getElementById('zcount');

slider.addEventListener('input', e=>{
  const n = +e.target.value;
  zeros.textContent = zcount.textContent = n;
  render(n);
});

render(+slider.value);     // initialise
</script>
